<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>Admin 用户管理</title>
    <link rel="stylesheet" href="/static/css/common.css">
    <style>
      body { padding-top:72px; }
      table { width:100%; border-collapse:collapse; margin:20px auto; max-width:600px; }
      th, td { border:1px solid #ccc; padding:8px 12px; text-align:left; }
      th { background:#f0f0f0; }
    </style>
</head>
<body>
  <div id="headerContainer"></div>
  <div class="main-content">
    <h1>用户管理</h1>
    <table id="userTable">
      <thead>
        <tr><th>ID</th><th>用户名</th><th>激活</th></tr>
      </thead>
      <tbody id="usersBody"></tbody>
    </table>
  </div>
  <script src="/static/js/common.js"></script>
  <script>
    (async function(){
      // 非管理员无法访问（基于 admin_token）
      const adminToken = localStorage.getItem("admin_token");
      if (!adminToken) {
        alert("请先以管理员账号登录");
        window.location.href = "/static/pages/login.html";
        return;
      }
      // 获取用户列表
      const res = await authFetch("/admin/users");
      if (!res.ok) {
        alert("加载失败");
        return;
      }
      const users = await res.json();
      const tbody = document.getElementById("usersBody");
      tbody.innerHTML = "";
      users.forEach(u => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${u.id}</td><td>${u.username}</td><td>${u.is_active}</td>`;
        tbody.appendChild(tr);
      });
    })();
  </script>
</body>
</html>